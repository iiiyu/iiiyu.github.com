<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"/><meta content="yes" name="apple-mobile-web-app-capable"/><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"/><meta content="telephone=no" name="format-detection"/><meta name="description" content="iOS Cocoa OSX 如果不能成为拯救世界的神 那就堕落到征服世界的魔吧 产品 产品原型 产品设计"/><title>iOS笔记 (4) | 萧宸宇</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"/><link rel="stylesheet" type="text/css" href="/css/pure-min.css"/><link rel="stylesheet" type="text/css" href="/css/grids-responsive-min.css"/><link rel="stylesheet" type="text/css" href="/css/style.css"/><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"/><link rel="apple-touch-icon" href="/apple-touch-icon.png"/><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"/><link rel="alternate" type="application/atom+xml" href="/atom.xml"/></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">iOS笔记 (4)</h1><a id="logo" href="/">萧宸宇</a><p class="description">如果不能成为拯救世界的神，那就堕落到征服世界的魔吧。</p></div><div id="nav-menu"><a href="/" class="current"><i class="icon-home"> 首页</i></a><a href="/archives/"><i class="icon-archive"> 归档</i></a><a href="/about-me/"><i class="icon-about"> 关于</i></a><a href="/atom.xml"><i class="icon-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post post-page"><h1 class="post-title">iOS笔记 (4)</h1><div class="post-meta">2012 Mar 21日 | </div><span data-disqus-identifier="2012/03/21/learning-ios-notes-four/" class="disqus-comment-count"></span><div class="post-content"><h1 id="iOS_u7B14_u8BB0_u2014_u2014_u4E5D_u5BAB_u89E3_u9501_u57FA_u7840_u90E8_u5206"><a href="#iOS_u7B14_u8BB0_u2014_u2014_u4E5D_u5BAB_u89E3_u9501_u57FA_u7840_u90E8_u5206" class="headerlink" title="iOS笔记——九宫解锁基础部分"></a>iOS笔记——九宫解锁基础部分</h1><h2 id="u76EE_u7684"><a href="#u76EE_u7684" class="headerlink" title="目的"></a>目的</h2><p>为了第一个App，一步一步的做出来。所以先弄最基本的想做一个类似Android九宫解锁的View。一开始完全没有思路啊。后来看了好几遍老头的画笑脸以后才有点思路。所以来一步一步做吧。</p>
<a id="more"></a>
<h2 id="u7EE7_u7EED_u626F_u6DE1MVC"><a href="#u7EE7_u7EED_u626F_u6DE1MVC" class="headerlink" title="继续扯淡MVC"></a>继续扯淡MVC</h2><p>作为一个从iOS5开始学起开发的娃来说，什么nib xib文件都是浮云。哥只懂在Xcode里面的storyboard里面拖拖拽拽。奈何没几个代码实例是Storyboard写的。让想重用代码的我，无法直接⌘-c ⌘-v。很是郁闷哈。不过经过慢慢理解，对于Xcode4里面用stroyboard有了一些小小的心得。分享一下。</p>
<p>一个VC是怎么构成的。在新建工程storyboard里面，我新拖入一个view<br>如图</p>
<p><img src="http://farm8.staticflickr.com/7252/6856181868_05dbe1fd8f.jpg" alt="storyboard1"></p>
<p>这是此时，这个仅仅是一个无人管的一段xml而已。因为你的程序里面没有相应的类去接管这个view。就像一个没人要的狗腿子。好可怜的。你需要把他找一个C的主子管着他，让view知道他应该怎么显示什么东西，对发生的事情做出什么样的反应。</p>
<ul>
<li><p>首先，你至少已经建立了接管这个view的controller类。</p>
</li>
<li><p>接着点击你view的这里</p>
</li>
</ul>
<p><img src="http://farm7.staticflickr.com/6222/7002295489_c0ea10a055_s.jpg" alt="storyboard2"></p>
<ul>
<li>从右侧选择你看见的这里的class的下拉框，选中你的controller</li>
</ul>
<p><img src="http://farm8.staticflickr.com/7240/6856181962_678f0eb0c4.jpg" alt="storyboard3"></p>
<p>有时候拖出来的view，并不能够满足你的需求。你可能会写一个subclass继承UIview来进行扩展。你也需要指定你拖出来的view他本身指向这个subview。</p>
<p>这是跟刚刚大同小异</p>
<ul>
<li><p>首先，你至少已经建立了这个继承UIView的view类。</p>
</li>
<li><p>接着点击你view的这里</p>
</li>
</ul>
<p><img src="http://farm7.staticflickr.com/6058/7002295577_c22eb920e6.jpg" alt="storyboard4"></p>
<ul>
<li>从右侧选择你看见的这里的class的下拉框，选中你的controller</li>
</ul>
<p><img src="http://farm8.staticflickr.com/7075/7002295599_3c2b3a65ea.jpg" alt="storyboard5"></p>
<p>这样你就完成了一对VC的创建了。</p>
<h2 id="u7A0B_u5E8F_u57FA_u672C_u8981_u505A_u7684_u4E8B_u60C5"><a href="#u7A0B_u5E8F_u57FA_u672C_u8981_u505A_u7684_u4E8B_u60C5" class="headerlink" title="程序基本要做的事情"></a>程序基本要做的事情</h2><ul>
<li>有一个view，view上有背景色</li>
<li>view上画9个按钮</li>
<li>view上能画线</li>
<li>controller能控制手指开始的地方，移动的地方，结束的地方。</li>
</ul>
<h2 id="u4E00_u6B65_u4E00_u6B65"><a href="#u4E00_u6B65_u4E00_u6B65" class="headerlink" title="一步一步"></a>一步一步</h2><h3 id="clone_u5DE5_u7A0B"><a href="#clone_u5DE5_u7A0B" class="headerlink" title="clone工程"></a>clone工程</h3><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">git</span>://github.com/iiiyu/Draw-Lock-Login.git</span><br></pre></td></tr></table></figure>
<p>项目结构</p>
<p><img src="http://farm7.staticflickr.com/6037/7002295643_06f72a4961.jpg" alt="ios4-1"></p>
<h3 id="Draw_Lock_u7C7B_u5206_u6790_28UIView_29"><a href="#Draw_Lock_u7C7B_u5206_u6790_28UIView_29" class="headerlink" title="Draw_Lock类分析(UIView)"></a>Draw_Lock类分析(UIView)</h3><p>点开Draw_Lock.m可以看到<br>两个方法,其中一个还是注释掉的。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">id</span>)initWithFrame:(<span class="built_in">CGRect</span>)frame</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> initWithFrame:frame];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="comment">// Initialization code</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Only override drawRect: if you perform custom drawing.</span></span><br><span class="line"><span class="comment">// An empty implementation adversely affects performance during animation.</span></span><br><span class="line">- (<span class="keyword">void</span>)drawRect:(<span class="built_in">CGRect</span>)rect</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>initWithFrame虽然看起来像初始化函数的样子，但是如果我们想初始化做一些事情的时候。是要重新写一个函数</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 老头说过不直接调用initWithFrame 而是调用awakeFromNib来进行初始化</span></span><br><span class="line"><span class="comment">// 进过测试 initWithFrame也不会被调用</span></span><br><span class="line"><span class="tag">-</span> (void)<span class="tag">awakeFromNib</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果需要初始化做一些事情，请重载awakeFromNib。</p>
<p>drawRect函数一开始是被注释掉。但是此函数可以在view上进行绘画。关于Quartz请参考相关官方文档。</p>
<p>仅仅记录我觉得重要的地方。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这个context就是画布，官方叫上下文。每次作画前要有。</span></span><br><span class="line"><span class="built_in">CGContextRef</span> context = <span class="built_in">UIGraphicsGetCurrentContext</span>();</span><br></pre></td></tr></table></figure>
<p>一开始我不会设置view的背景，就想把画一个和view相等的矩形。这样不就是背景了。后来发现是可以直接设置的。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置view的背景颜色</span></span><br><span class="line"><span class="keyword">self</span><span class="variable">.backgroundColor</span> = [<span class="built_in">UIColor</span> darkGrayColor];</span><br></pre></td></tr></table></figure>
<p>把要加入的9个宫。看做一个个的view。我们先创建这些view。然后用addSubview加入Draw_Lock这个view当中，最后调整这些宫的位置就完成了图像的绘制。</p>
<p>每一个宫由两张图片构成。一张为默认，一张为highlighted属性的。当我们碰到宫时候，设置他的highlighted为YES。</p>
<p>然后是线的绘制。当手指触碰到宫的时候，才吧宫的中心作为起点开始绘制线。绘制的线在没有遇到第二个宫的时候跟随手指，如果遇到宫。就绘制完成一条直线。然后把终点的坐标为下一条线的起点。直到手指离开屏幕。</p>
<h3 id="ViewController_u7C7B_u5206_u6790_uFF08UIViewController_uFF09"><a href="#ViewController_u7C7B_u5206_u6790_uFF08UIViewController_uFF09" class="headerlink" title="ViewController类分析（UIViewController）"></a>ViewController类分析（UIViewController）</h3><p>手指触摸开始</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">-</span> (void)<span class="tag">touchesBegan</span>:(NSSet *)<span class="tag">touches</span> <span class="tag">withEvent</span>:(UIEvent *)<span class="tag">event</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>手指移动</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">-</span> (void)<span class="tag">touchesMoved</span>:(NSSet *)<span class="tag">touches</span> <span class="tag">withEvent</span>:(UIEvent *)<span class="tag">event</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>触摸结束</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">-</span> (void)<span class="tag">touchesEnded</span>:(NSSet *)<span class="tag">touches</span> <span class="tag">withEvent</span>:(UIEvent *)<span class="tag">event</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="u6700_u540E"><a href="#u6700_u540E" class="headerlink" title="最后"></a>最后</h3><p>大概在山寨这个九宫的时候就遇到很多问题。隔了一天，能想到一一记录。当然，还有更多的问题。所以最好就直接看github项目里面有更详细的注释和完整的代码。很多时候，觉得写代码比写blog轻松多了。</p>
</div><div class="tags"><a href="/tags/iOS/">iOS</a></div><div class="post-nav"><a href="/2012/03/25/ioscon-guangzhou/" class="pre"><i class="icon-previous">iOScon 广州之行</i></a><a href="/2012/03/14/talk-about-the-software/" class="next">谈谈软件的一些事<i class="icon-next"></i></a></div><div id="disqus_thread"><script>var disqus_shortname = 'iiiyu';
var disqus_identifier = '2012/03/21/learning-ios-notes-four/';
var disqus_title = 'iOS笔记 (4)';
var disqus_url = 'http://iiiyu.com/2012/03/21/learning-ios-notes-four/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//iiiyu.disqus.com/count.js" async="async"></script></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><input placeholder="Search" type="text" class="st-default-search-input"/></div><div class="widget"><div class="widget-title">标签</div><div class="tagcloud"><a href="/tags/just-talk/" style="font-size: 15px;">just-talk</a> <a href="/tags/Software/" style="font-size: 15px;">Software</a> <a href="/tags/iOS/" style="font-size: 15px;">iOS</a> <a href="/tags/read-book-notes/" style="font-size: 15px;">read book notes</a> <a href="/tags/Mac/" style="font-size: 15px;">Mac</a> <a href="/tags/Design/" style="font-size: 15px;">Design</a> <a href="/tags/Emacs/" style="font-size: 15px;">Emacs</a></div></div><div class="widget"><div class="widget-title">最新文章</div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2015/01/31/read-the-tipping-point/">读书笔记 「引爆点」</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/01/20/2014-oh-my-star-app-annual-summary/">2014年 Oh My Star 总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/01/16/read-contagious/">读书笔记 「疯传」</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/12/26/learning-ios-notes-thirty-six/">iOS 学习笔记 (36)  ReactiveCocoa 用 RACSignal 替代 Delegate</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/10/20/iCloud-and-iCloud-Drive/">iCloud 和 iCloud Drive</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/04/23/learn-ui-design-two/">怎样使用Sketch 3切图 —— 从想入设计大门的菜逼进化到切图仔（未完成）</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/04/08/learning-ios-notes-thirty-five/">iOS笔记(35) 格志周年系列之夏令时(三) 临时花絮</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/03/25/learn-ui-design-one/">学习UI设计笔记(一)</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/03/19/learning-ios-notes-thirty-four/">iOS笔记(34) 格志周年系列之夏令时(二)</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/03/18/learning-ios-notes-thirty-three/">iOS笔记(33) 格志周年系列之夏令时(一)</a></li></ul></div><div class="widget"><div class="widget-title">最近评论</div><script type="text/javascript" src="//iiiyu.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title">友情链接</div><ul></ul><a href="http://www.ohmystarapp.com/" title="Oh My Star" target="_blank">Oh My Star</a><ul></ul><a href="http://griddiaryapp.com" title="Grid Diary" target="_blank">Grid Diary</a></div></div></div></div><div id="footer">© <a href="/" rel="nofollow">萧宸宇.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div><a id="rocket" href="#top" class="show"></a><script src="/js/jquery.min.js" type="text/javascript"></script>
<script src="/js/totop.js" type="text/javascript"></script><script src="/js/fancybox.pack.js" type="text/javascript"></script>
<script src="/js/jquery.fancybox.js" type="text/javascript"></script><link rel="stylesheet" href="/css/jquery.fancybox.css" type="text/css"><script>(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

_st('install','Nm83mrKyygUM42socQtA','2.0.0');
</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-29764460-1','auto');ga('send','pageview');
</script></div></body></html>